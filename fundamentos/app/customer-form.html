<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clientes</title>
    <link rel="stylesheet" href="theme/style.css">
</head>

<body>
    <header class="cabecera-principal">
        <img id="logo" src="./images/logo.png" alt="Logotipo de ViewNext">
        <nav class="cabecera-principal__menu">
            <a href="index.html">inicio</a>
            <a href="customer-form.html">catalogo</a>
            <a href="tiendas">tiendas</a>
            <a href="socio.html">hazte socio</a>
            <a href="contactos.html">contacto</a>
        </nav>
        <form class="cabecera-principal__login">
            <input type="text" name="user" size="8" placeholder="Usuario">
            <input type="password" name="password" size="8" placeholder="Contraseña">
            <input type="submit" value="Login">
            <input type="submit" value="Registrarse">
        </form>
    </header>
    <main>
        <!-- <form class="form form--col2">
            <div class="field col-2">
                <label for="customer_id">Código</label>
                <input type="number" id="customer_id" name="customer_id" placeholder="Código del usuario" required>
            </div>
            <div class="field">
                <label for="store_id">Tienda</label>
                <select id="store_id" name="store_id">
                    <option value="1">Tienda 1</option>
                    <option value="2">Tienda 2</option>
                </select>
            </div>
            <div class="field colspan-2">
                <label for="first_name">Nombre</label>
                <input type="text" id="first_name" name="first_name" required minlength="2" maxlength="50">
            </div>
            <div class="field colspan-2">
                <label for="last_name">Apellidos</label>
                <input type="text" id="last_name" name="last_name" minlength="2" maxlength="50">
            </div>
            <div class="field">
                <label for="email">Correo</label>
                <input type="email" id="email" name="email" placeholder="Correo electrónico" required>
            </div>
            <div class="field row-5x2">
                <label for="address_id">Dirección</label>
                <div class="field__radio">
                    <span>
                        <input type="radio" id="address_id" name="address_id" checked value="1">
                        Casa
                    </span>
                    <span>
                        <input type="radio" name="address_id" value="2">
                        Trabajo
                    </span>
                </div>
            </div>
            <div class="field">
                <label for="active">Activo</label>
                <input type="checkbox" id="active" name="active" value="true" checked>
            </div>
            <div class="field">
                <label for="create_date">F. Creación</label>
                <input type="date" id="create_date" name="create_date">
            </div>
            <div class="field">
                <label for="last_update">Última modificacion</label>
                <input type="date" id="last_update" name="last_update">
            </div>
            <div class="form__comand">
                <input type="submit" value="enviar">
                <input type="button" value="volver">
            </div>
        </form> -->
        <summary id="listaDeErrores">

        </summary>
        <form id="miForm" class="form form--col4">
            <label for="customer_id">Códigooooo</label>
            <input type="number" id="customer_id" name="customer_id" placeholder="Código del usuario" required data-label="otro"><output
                class="error-msg" id="customer_idErr" hidden></output>
            <label for="store_id">Tienda</label>
            <select id="store_id" name="store_id">
                <option value="1">Tienda 1</option>
                <option value="2">Tienda 2</option>
            </select>
            <label for="first_name">Nombre</label>
            <input class="colspan-3" type="text" id="first_name" name="first_name" required minlength="2"
                maxlength="50" data-label="Nombre"><output class="error-msg" id="first_nameErr" hidden></output>
            <label for="last_name">Apellidos</label>
            <input class="colspan-3" type="text" id="last_name" name="last_name" minlength="2" maxlength="50"><output
                class="error-msg" id="last_nameErr" hidden></output>
            <label for="email">Correo</label>
            <input class="colspan-3" type="email" id="email" name="email" placeholder="Correo electrónico"
                required><output class="error-msg" id="emailErr" hidden></output>
            <label for="address_id">Dirección</label>
            <div class="field__radio">
                <input type="radio" id="address_id" name="address_id" checked value="1">
                Casa
                <input type="radio" name="address_id" value="2">
                Trabajo
            </div>
            <label for="active">Activo</label>
            <input type="checkbox" id="active" name="active" value="true" checked>
            <label for="create_date">F. Creación</label>
            <input type="date" id="create_date" name="create_date">
            <label for="last_update">Última modificacion</label>
            <input type="date" id="last_update" name="last_update">
            <label for="nif">DNI</label>
            <input type="text" id="nif" name="nif" required minlength="2"><output class="error-msg" id="nifErr"
                hidden></output>
            <div class="form__comand">
                <input id="btnEnviar" type="button" value="enviar">
                <input type="button" value="volver">
            </div>
        </form>
    </main>
    <footer class="pie-principal">
        <div>
            &copy; 2021 Todos los derechos reservados | <a href="/aviso-legal" target="_blank">Aviso Legal</a> | <a
                href="/politica-de-privacidad" target="_blank">Política de Privacidad</a> | <a
                href="/politica-de-cookies" target="_blank">Política de Cookies</a>
        </div>
    </footer>

    <script src="js/ejercicios-js.js"></script>
    <script>
        // document.querySelector('#nif').addEventListener('change', function (ev) {
        //     let msg = '';
        //     if (ev.target.value && !esNIF(ev.target.value)) {
        //        msg = 'No es un nif valido';
        //     }
        //     ev.target.setCustomValidity(msg); // '#'+ev.target.name+'Err'
        //     let cntr = document.querySelector(`#${ev.target.name}Err`)
        //     cntr.hidden = ev.target.validationMessage ? false : true;
        //     cntr.textContent = ev.target.validationMessage;
        // });
        let btnEnviar = document.querySelector('#btnEnviar');
        document.querySelectorAll('input').forEach(tag => tag.addEventListener('change', function (ev) {
            let msg = '';
            switch (ev.target.name) {
                case 'nif':
                    if (ev.target.value && !esNIF(ev.target.value)) {
                        msg = 'No es un nif valido';
                    }
                    break;
                case 'last_name':
                    if (ev.target.value && !estaEnMayuscula(ev.target.value)) {
                        msg = 'No esta en mayusculas';
                    }
                    break;
            }
            ev.target.setCustomValidity(msg); // '#'+ev.target.name+'Err'
            let cntr = document.querySelector(`#${ev.target.name}Err`)
            cntr.hidden = ev.target.validationMessage ? false : true;
            cntr.textContent = ev.target.validationMessage;
            // btnEnviar.disabled = !document.forms.miForm.checkValidity();
        }));
        btnEnviar.addEventListener('click', function (ev) {
            let miForm = document.forms.miForm;
            if (miForm.checkValidity()) {
                // document.querySelector('#listaDeErrores').textContent = '';
                let datos = {}
                for (let item of miForm.elements) {
                    if(item.name) datos[item.name] = item.value;
                }
                alert(`Envio ${JSON.stringify(datos)}`)
                // miForm.submit();
            } else {
                let msg = '';
                for (let item of miForm.elements) {
                    // if (!item.checkValidity()) msg += `<li>${item.name}: ${item.validationMessage}</li>`;
                    // if (!item.checkValidity()) msg += `<li>${item.dataset.label}: ${item.validationMessage}</li>`;
                    if (!item.checkValidity()) msg += `<li>${document.querySelector('label[for='+item.name+']').textContent}: ${item.validationMessage}</li>`;
                }
                document.querySelector('#listaDeErrores').innerHTML = `<h3>Sumario</h3><ul>${msg}</ul>`;
            }
        });
    </script>
</body>

</html>